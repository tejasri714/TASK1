<!DOCTYPE html>
<html lang="en">
<head><!-- same head --></head>
<body>
  <div class="form-container" id="step1">
    <h2>Forgot Password</h2>
    <form id="forgotForm">
      <input name="email" type="email" placeholder="Email" required />
      <button type="submit">Send OTP</button>
    </form>
  </div>

  <div class="form-container" id="step2" style="display:none;">
    <h2>Verify OTP</h2>
    <form id="verifyForm">
      <input name="otp" type="text" placeholder="OTP" required />
      <button type="submit">Verify</button>
    </form>
  </div>

  <div class="form-container" id="step3" style="display:none;">
    <h2>Reset Password</h2>
    <form id="resetForm">
      <input name="newPassword" type="password" placeholder="New Password" required />
      <button type="submit">Reset Password</button>
    </form>
  </div>

  <script>
    let generatedOtp = '';
    let userEmail = '';
    const GSHEET_URL = 'YOUR_GOOGLE_SCRIPT_URL'; // in config.js

    document.getElementById('forgotForm').addEventListener('submit', e => {
      e.preventDefault();
      userEmail = e.target.email.value;
      generatedOtp = Math.floor(100000 + Math.random() * 900000).toString();
      alert('Simulated OTP (dev): ' + generatedOtp);
      document.getElementById('step1').style.display='none';
      document.getElementById('step2').style.display='block';
    });

    document.getElementById('verifyForm').addEventListener('submit', e => {
      e.preventDefault();
      if (e.target.otp.value === generatedOtp) {
        document.getElementById('step2').style.display='none';
        document.getElementById('step3').style.display='block';
      } else alert('Incorrect OTP');
    });

    document.getElementById('resetForm').addEventListener('submit', e => {
      e.preventDefault();
      fetch(GSHEET_URL, {
        method: 'POST',
        body: JSON.stringify({ email: userEmail, newPassword: e.target.newPassword.value, action: 'reset' }),
        headers: { 'Content-Type': 'application/json' }
      }).then(r=>r.text()).then(() => {
        alert('Password reset â€” implement actual flow later.');
        window.location = 'login.html';
      });
    });
  </script>
</body>
</html>
